import{i as Je,g as Xe,a as Ve,r as x,o as Ye,b as le,c as G,j as e,U as J,C as Se,M as Qe,X,d as Te,H as Ce,L as Ze,e as ea,s as aa,f as sa,u as ne,h as V,k as Ke,l as ta,A as la,m as Me,F as na,n as Fe,K as ia,B as ra,S as oa,P as ie,p as ue,T as me,q as da,R as Y,t as ca,v as ua,w as ma,x as xa,y as ga,I as pa,z as ha}from"./vendor-AfEk221X.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))p(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&p(h)}).observe(document,{childList:!0,subtree:!0});function d(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function p(r){if(r.ep)return;r.ep=!0;const c=d(r);fetch(r.href,c)}})();let xe;try{typeof __firebase_config<"u"?xe=JSON.parse(__firebase_config):xe={apiKey:"AIzaSyBwf0YITW6dueNHMtfD_d-fA0TcVhBT06c",authDomain:"rt-05-rw-09.firebaseapp.com",projectId:"rt-05-rw-09",storageBucket:"rt-05-rw-09.firebasestorage.app",messagingSenderId:"656172952610",appId:"1:656172952610:web:f6c98f827617589e73ae7b"}}catch(n){console.error("Error parsing firebase config",n)}const Re=Je(xe),z=Xe(Re),re=Ve(Re),Pe=n=>new Promise((o,d)=>{const p=new FileReader;p.readAsDataURL(n),p.onload=r=>{var h;const c=new Image;c.src=(h=r.target)==null?void 0:h.result,c.onload=()=>{const f=document.createElement("canvas");let v=c.width,N=c.height;const y=800;v>N?v>y&&(N*=y/v,v=y):N>y&&(v*=y/N,N=y),f.width=v,f.height=N;const k=f.getContext("2d");if(!k){d(new Error("Canvas ctx error"));return}k.drawImage(c,0,0,v,N),o(f.toDataURL("image/jpeg",.7))},c.onerror=f=>d(f)},p.onerror=r=>d(r)}),Ae=()=>new Date().toISOString().split("T")[0],H={nomorKK:"",alamat:"",statusHubungan:"Kepala Keluarga",isPendatang:!1,nik:"",nama:"",tempatLahir:"",tanggalLahir:"",jenisKelamin:"Laki-laki",golDarah:"-",agama:"Islam",statusPerkawinan:"Belum Kawin",pendidikan:"SMA/Sederajat",pekerjaan:"",statusRumah:"Milik Sendiri",jenisBpjs:"Tidak Memiliki",hasMobil:!1,platMobil:"",hasMotor:!1,platMotor:"",catatan:"",isMoved:!1,alamatPindah:"",tanggalPindah:"",files:[]},oe={namaKegiatan:"",tanggal:"",deskripsi:"",keterangan:"",files:[]},de={namaPelapor:"",deskripsi:"",status:"Menunggu",tanggapan:"",files:[],tanggalPengaduan:"",tanggalPenyelesaian:""};function fa(){const[n,o]=x.useState(null),[d,p]=x.useState("penduduk"),[r,c]=x.useState([]),[h,f]=x.useState([]),[v,N]=x.useState([]),[y,k]=x.useState(!1),[ge,Q]=x.useState(!1),[b,pe]=x.useState("resident"),[he,E]=x.useState(null),[L,fe]=x.useState(""),[_,be]=x.useState(""),[Z,Ie]=x.useState("Semua"),[O,Be]=x.useState(""),[U,je]=x.useState(null),[j,F]=x.useState("kk"),[Ee,ee]=x.useState(!1),[K,$]=x.useState({id:"",tanggapan:"",files:[]}),[ae,ve]=x.useState(!1),[Ne,se]=x.useState(null),[i,u]=x.useState(H),[S,C]=x.useState(oe),[R,A]=x.useState(de);x.useEffect(()=>((async()=>{try{typeof __initial_auth_token<"u"&&__initial_auth_token?await aa(re,__initial_auth_token):await sa(re)}catch(s){console.error("Auth Error:",s)}})(),Ye(re,o)),[]),x.useEffect(()=>{if(!n)return;const a=le(G(z,"residents"),l=>{const g=l.docs.map(m=>({id:m.id,...m.data(),files:m.data().files||[],catatan:m.data().catatan||""}));g.sort((m,B)=>{const we=["Kepala Keluarga","Istri","Suami","Anak"];return we.indexOf(m.statusHubungan)-we.indexOf(B.statusHubungan)}),c(g)},l=>console.error("Error Resident:",l)),s=le(G(z,"activities"),l=>{const g=l.docs.map(m=>({id:m.id,...m.data(),files:m.data().files||[]}));g.sort((m,B)=>new Date(B.tanggal).getTime()-new Date(m.tanggal).getTime()),f(g)},l=>console.error("Error Activity:",l)),t=le(G(z,"complaints"),l=>{const g=l.docs.map(m=>({id:m.id,...m.data(),files:m.data().files||[],tanggalPengaduan:m.data().tanggalPengaduan||"",tanggalPenyelesaian:m.data().tanggalPenyelesaian||""}));N(g.sort((m,B)=>m.status==="Menunggu"&&B.status!=="Menunggu"?-1:m.status!=="Menunggu"&&B.status==="Menunggu"?1:0))},l=>console.error("Error Complaint:",l));return()=>{a(),s(),t()}},[n]);const D=x.useMemo(()=>{const a=r.filter(l=>!l.isMoved),s=r.filter(l=>l.isMoved),t=a.filter(l=>l.statusHubungan==="Kepala Keluarga");return{totalWarga:a.length,totalKK:t.length,totalPindah:s.length,totalPendatang:a.filter(l=>l.isPendatang).length,rumahMilik:t.filter(l=>l.statusRumah==="Milik Sendiri").length,rumahSewa:t.filter(l=>l.statusRumah==="Sewa/Kontrak").length,rumahMenumpang:t.filter(l=>l.statusRumah==="Menumpang").length}},[r]),He=async a=>{if(a.preventDefault(),!n)return alert("Sistem belum siap.");if(y)return;k(!0);let s="",t={};if(b==="resident"||b==="move"?(s="residents",t=i):b==="activity"?(s="activities",t=S):b==="complaint"&&(s="complaints",t=R,!ae&&!t.tanggalPengaduan&&(t.tanggalPengaduan=Ae())),new Blob([JSON.stringify(t)]).size>9e5){alert("Ukuran data/foto terlalu besar. Mohon kurangi jumlah foto."),k(!1);return}try{const l=G(z,s);ae&&Ne?(await ne(V(l,Ne),{...t,updatedAt:Ke()}),alert("Data berhasil diperbarui!"),I()):(await ta(l,{...t,createdAt:Ke()}),b==="resident"?confirm(`Data berhasil disimpan!

Klik OK untuk tambah anggota keluarga lain.
Klik Cancel untuk selesai.`)?u(m=>({...H,nomorKK:m.nomorKK,alamat:m.alamat,statusRumah:m.statusRumah,statusHubungan:"Anak",isPendatang:m.isPendatang})):I():(alert("Data berhasil disimpan!"),I()))}catch(l){console.error("Gagal Menyimpan:",l),alert(`Gagal menyimpan data.
Error: ${l.message}`)}finally{k(!1)}},W=async(a,s)=>{if(confirm("Yakin hapus data ini?"))try{await ga(V(z,a,s))}catch(t){alert("Gagal menghapus: "+t.message)}},te=async a=>{const s=Array.from(a.target.files||[]),t=[];for(const l of s)try{const g=await Pe(l);t.push(g)}catch(g){console.error(g)}b==="resident"?u(l=>({...l,files:[...l.files,...t]})):b==="activity"?C(l=>({...l,files:[...l.files||[],...t]})):b==="complaint"&&A(l=>({...l,files:[...l.files||[],...t]})),a.target.value=""},Le=a=>{b==="resident"?u(s=>({...s,files:s.files.filter((t,l)=>l!==a)})):b==="activity"?C(s=>({...s,files:(s.files||[]).filter((t,l)=>l!==a)})):b==="complaint"&&A(s=>({...s,files:(s.files||[]).filter((t,l)=>l!==a)}))},_e=a=>{$({id:a,tanggapan:"",files:[]}),ee(!0)},Oe=async a=>{const s=Array.from(a.target.files||[]),t=[];for(const l of s)try{const g=await Pe(l);t.push(g)}catch(g){console.error(g)}$(l=>({...l,files:[...l.files,...t]})),a.target.value=""},Ue=async a=>{if(a.preventDefault(),!(!n||!K.id))try{const s=v.find(g=>g.id===K.id),l=[...(s==null?void 0:s.files)||[],...K.files];await ne(V(z,"complaints",K.id),{status:"Selesai",tanggapan:K.tanggapan,files:l,tanggalPenyelesaian:Ae()}),ee(!1)}catch(s){console.error(s),alert("Gagal menyelesaikan pengaduan.")}},$e=async(a,s)=>{try{const t={status:s};s!=="Selesai"&&(t.tanggalPenyelesaian=""),await ne(V(z,"complaints",a),t)}catch(t){console.error(t),alert("Gagal update status")}},M=(a,s)=>{pe(a),k(!1),s?(ve(!0),se(s.id),a==="resident"&&u(s),a==="activity"&&C({...s,files:s.files||[]}),a==="complaint"&&A({...s,files:s.files||[]})):(ve(!1),se(null),a==="resident"&&u(H),a==="activity"&&C(oe),a==="complaint"&&A(de)),Q(!0)},ye=a=>{u({...a,alamatPindah:"",tanggalPindah:""}),se(a.id),pe("move"),Q(!0)},I=()=>{Q(!1),ee(!1),u(H),C(oe),A(de)},q=(a,s)=>e.jsx("div",{className:"flex gap-2 mt-2 overflow-x-auto pb-2",children:a==null?void 0:a.map((t,l)=>e.jsxs("div",{className:"w-16 h-16 relative flex-shrink-0 group",children:[e.jsx("img",{src:t,className:"w-full h-full object-cover rounded border border-gray-200 cursor-pointer",onClick:()=>E(t)}),e.jsx("button",{type:"button",onClick:g=>{g.stopPropagation(),s?s(l):Le(l)},className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full p-0.5 shadow transition",children:e.jsx(X,{size:12})})]},l))}),ke=a=>!a||a.length===0?null:e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-100",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[e.jsx(pa,{size:12})," Lampiran (",a.length,")"]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar",children:a.map((s,t)=>e.jsx("div",{className:"w-10 h-10 rounded border border-gray-200 overflow-hidden cursor-pointer hover:opacity-80",onClick:()=>E(s),children:e.jsx("img",{src:s,className:"w-full h-full object-cover"})},t))})]}),We=()=>{const a=r.filter(t=>O===""||t.nama.toLowerCase().includes(O.toLowerCase())||t.nomorKK.includes(O)?j==="kk"?t.statusHubungan==="Kepala Keluarga"&&!t.isMoved:j==="pindah"?t.isMoved:j==="datang"?t.isPendatang&&!t.isMoved:j==="milik"?t.statusHubungan==="Kepala Keluarga"&&!t.isMoved&&t.statusRumah==="Milik Sendiri":j==="sewa"?t.statusHubungan==="Kepala Keluarga"&&!t.isMoved&&t.statusRumah==="Sewa/Kontrak":j==="numpang"?t.statusHubungan==="Kepala Keluarga"&&!t.isMoved&&t.statusRumah==="Menumpang":!1:!1),s=t=>r.filter(l=>l.nomorKK===t);if(U){const t=s(U);return e.jsxs("div",{className:"animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("button",{onClick:()=>je(null),className:"p-2 bg-white border rounded-full",children:e.jsx(la,{size:20})}),e.jsxs("h2",{className:"text-xl font-bold",children:["Detail Keluarga (KK: ",U,")"]}),e.jsxs("button",{onClick:()=>{const l=t.find(m=>m.statusHubungan==="Kepala Keluarga")||t[0],g={...H,nomorKK:U,alamat:(l==null?void 0:l.alamat)||"",isPendatang:l==null?void 0:l.isPendatang};M("resident"),u(g)},className:"ml-auto bg-green-600 text-white px-3 py-2 rounded flex items-center gap-1",children:[e.jsx(Me,{size:16})," Tambah Anggota"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(l=>e.jsx(De,{data:l,onEdit:()=>M("resident",l),onDelete:()=>W("residents",l.id),onMove:()=>ye(l),onPreview:g=>E(g)},l.id))})]})}return e.jsxs("div",{className:"pb-20",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6",children:[e.jsx(T,{icon:e.jsx(J,{}),label:"Total Warga",value:D.totalWarga,color:"bg-blue-600",active:!1,onClick:()=>{}}),e.jsx(T,{icon:e.jsx(na,{}),label:"Kepala Keluarga",value:D.totalKK,color:"bg-indigo-500",active:j==="kk",onClick:()=>F("kk")}),e.jsx(T,{icon:e.jsx(Fe,{}),label:"Warga Pindah",value:D.totalPindah,color:"bg-red-500",active:j==="pindah",onClick:()=>F("pindah")}),e.jsx(T,{icon:e.jsx(Me,{}),label:"Warga Datang",value:D.totalPendatang,color:"bg-green-500",active:j==="datang",onClick:()=>F("datang")})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 mb-2",children:"FILTER STATUS RUMAH (KK)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(T,{icon:e.jsx(Ce,{}),label:"Milik Sendiri",value:D.rumahMilik,color:"bg-emerald-600",active:j==="milik",onClick:()=>F("milik")}),e.jsx(T,{icon:e.jsx(ia,{}),label:"Sewa",value:D.rumahSewa,color:"bg-orange-500",active:j==="sewa",onClick:()=>F("sewa")}),e.jsx(T,{icon:e.jsx(ra,{}),label:"Menumpang",value:D.rumahMenumpang,color:"bg-purple-500",active:j==="numpang",onClick:()=>F("numpang")})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(oa,{className:"absolute left-3 top-2.5 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Cari Nama / KK...",value:O,onChange:t=>Be(t.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("button",{onClick:()=>M("resident"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(ie,{size:18})," Baru"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(t=>["kk","milik","sewa","numpang"].includes(j)?e.jsx(ba,{data:t,memberCount:s(t.nomorKK).length,onClick:()=>je(t.nomorKK)},t.id):e.jsx(De,{data:t,onEdit:()=>M("resident",t),onDelete:()=>W("residents",t.id),onMove:()=>ye(t),onPreview:l=>E(l)},t.id))})]})},qe=()=>{const a=h.filter(s=>!(L&&s.tanggal<L||_&&s.tanggal>_));return e.jsxs("div",{className:"pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Kegiatan RT"}),e.jsxs("button",{onClick:()=>M("activity"),className:"bg-purple-600 text-white px-3 py-2 rounded flex items-center gap-1",children:[e.jsx(ie,{size:18})," Tambah"]})]}),e.jsxs("div",{className:"flex gap-2 mb-4 items-center bg-white p-2 rounded border",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-500",children:[e.jsx(Se,{size:14,className:"inline"})," Periode:"]}),e.jsx("input",{type:"date",value:L,onChange:s=>fe(s.target.value),className:"border rounded text-sm px-1"}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"date",value:_,onChange:s=>be(s.target.value),className:"border rounded text-sm px-1"}),(L||_)&&e.jsx("button",{onClick:()=>{fe(""),be("")},className:"text-xs text-red-500",children:"Reset"})]}),e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"font-bold text-lg",children:s.namaKegiatan}),e.jsx("span",{className:"text-sm bg-purple-100 text-purple-700 px-2 py-1 rounded h-fit",children:s.tanggal})]}),e.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap",children:s.deskripsi}),s.keterangan&&e.jsx("div",{className:"text-xs bg-gray-50 p-2 rounded border",children:s.keterangan}),ke(s.files),e.jsxs("div",{className:"flex gap-2 justify-end mt-2",children:[e.jsxs("button",{onClick:()=>M("activity",s),className:"text-blue-600 text-sm flex items-center gap-1",children:[e.jsx(ue,{size:14})," Edit"]}),e.jsxs("button",{onClick:()=>W("activities",s.id),className:"text-red-600 text-sm flex items-center gap-1",children:[e.jsx(me,{size:14})," Hapus"]})]})]},s.id))})]})},Ge=()=>{const a=v.filter(s=>!(Z!=="Semua"&&s.status!==Z));return e.jsxs("div",{className:"pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Pengaduan"}),e.jsxs("button",{onClick:()=>M("complaint"),className:"bg-orange-600 text-white px-3 py-2 rounded flex items-center gap-1",children:[e.jsx(ie,{size:18})," Buat"]})]}),e.jsxs("div",{className:"flex gap-2 mb-4 items-center bg-white p-2 rounded border",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-500",children:[e.jsx(da,{size:14,className:"inline"})," Status:"]}),e.jsxs("select",{value:Z,onChange:s=>Ie(s.target.value),className:"border rounded text-sm px-2 py-1",children:[e.jsx("option",{value:"Semua",children:"Semua"}),e.jsx("option",{value:"Menunggu",children:"Menunggu"}),e.jsx("option",{value:"Proses",children:"Proses"}),e.jsx("option",{value:"Selesai",children:"Selesai"})]})]}),e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-bold",children:s.namaPelapor}),e.jsx("span",{className:`text-xs px-2 py-1 rounded font-bold ${s.status==="Selesai"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:s.status})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.deskripsi}),ke(s.files),s.status==="Selesai"&&e.jsxs("div",{className:"bg-green-50 p-2 rounded text-xs text-green-800 border border-green-200",children:["âœ… ",s.tanggapan]}),e.jsxs("div",{className:"flex gap-2 justify-end mt-2 pt-2 border-t flex-wrap",children:[["Menunggu","Proses"].map(t=>e.jsx("button",{onClick:()=>$e(s.id,t),className:"text-xs border px-2 py-1 rounded hover:bg-gray-50",children:t},t)),e.jsx("button",{onClick:()=>_e(s.id),className:"text-xs border px-2 py-1 rounded hover:bg-green-50 text-green-700 font-bold",children:"Selesai"}),e.jsxs("div",{className:"ml-auto flex gap-2",children:[e.jsx("button",{onClick:()=>M("complaint",s),className:"text-blue-500",children:e.jsx(ue,{size:16})}),e.jsx("button",{onClick:()=>W("complaints",s.id),className:"text-red-500",children:e.jsx(me,{size:16})})]})]})]},s.id))})]})};return e.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-800 font-sans",children:[e.jsxs("header",{className:"bg-white border-b sticky top-0 z-30 shadow-sm p-4",children:[e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-600 text-white p-2 rounded",children:e.jsx(J,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-sm leading-tight",children:"RT. 05 RW. 09 Buana Permai"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Sistem Data"})]})]}),e.jsxs("div",{className:"flex mt-4 border-t pt-2 gap-4 overflow-x-auto",children:[e.jsx(ce,{active:d==="penduduk",onClick:()=>p("penduduk"),icon:e.jsx(J,{size:16}),label:"Warga"}),e.jsx(ce,{active:d==="kegiatan",onClick:()=>p("kegiatan"),icon:e.jsx(Se,{size:16}),label:"Kegiatan"}),e.jsx(ce,{active:d==="pengaduan",onClick:()=>p("pengaduan"),icon:e.jsx(Qe,{size:16}),label:"Aduan"})]})]}),e.jsxs("main",{className:"max-w-6xl mx-auto px-4 py-4",children:[d==="penduduk"&&We(),d==="kegiatan"&&qe(),d==="pengaduan"&&Ge()]}),he&&e.jsxs("div",{className:"fixed inset-0 z-[60] bg-black/90 flex items-center justify-center p-4 cursor-pointer",onClick:()=>E(null),children:[e.jsx("img",{src:he,className:"max-w-full max-h-full rounded shadow-lg object-contain"}),e.jsx("button",{className:"absolute top-4 right-4 text-white bg-black/50 rounded-full p-2 hover:bg-black/70 transition",children:e.jsx(X,{size:24})})]}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white w-full rounded-xl max-w-lg relative flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50 rounded-t-xl sticky top-0 z-10",children:[e.jsxs("h2",{className:"font-bold text-lg capitalize",children:[ae?"Edit":"Tambah"," ",b]}),e.jsx("button",{onClick:I,children:e.jsx(X,{size:24,className:"text-gray-500"})})]}),e.jsxs("form",{onSubmit:He,className:"p-4 overflow-y-auto space-y-6",children:[b==="resident"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-bold text-blue-700 border-b pb-2 flex gap-2",children:[e.jsx(Te,{size:18})," Data Pribadi"]}),e.jsx(w,{label:"NIK",value:i.nik,onChange:a=>u({...i,nik:a.target.value}),required:!0}),e.jsx(w,{label:"Nama Lengkap",value:i.nama,onChange:a=>u({...i,nama:a.target.value}),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(w,{label:"Tempat Lahir",value:i.tempatLahir,onChange:a=>u({...i,tempatLahir:a.target.value})}),e.jsx(w,{label:"Tgl Lahir",type:"date",value:i.tanggalLahir,onChange:a=>u({...i,tanggalLahir:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(P,{label:"Jenis Kelamin",value:i.jenisKelamin,onChange:a=>u({...i,jenisKelamin:a.target.value}),options:["Laki-laki","Perempuan"]}),e.jsx(P,{label:"Gol. Darah",value:i.golDarah,onChange:a=>u({...i,golDarah:a.target.value}),options:["-","A","B","AB","O"]})]}),e.jsx(P,{label:"Agama",value:i.agama,onChange:a=>u({...i,agama:a.target.value}),options:["Islam","Kristen","Katolik","Hindu","Buddha","Konghucu"]}),e.jsx(P,{label:"Pendidikan Terakhir",value:i.pendidikan,onChange:a=>u({...i,pendidikan:a.target.value}),options:["Tidak/Belum Sekolah","SD/Sederajat","SMP/Sederajat","SMA/Sederajat","D1","D2","D3","S1","S2","S3"]}),e.jsx(w,{label:"Pekerjaan",value:i.pekerjaan,onChange:a=>u({...i,pekerjaan:a.target.value})}),e.jsx(P,{label:"Status Kawin",value:i.statusPerkawinan,onChange:a=>u({...i,statusPerkawinan:a.target.value}),options:["Belum Kawin","Kawin","Cerai Hidup","Cerai Mati"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-bold text-blue-700 border-b pb-2 flex gap-2",children:[e.jsx(J,{size:18})," Data Keluarga"]}),e.jsx(w,{label:"Nomor KK",value:i.nomorKK,onChange:a=>u({...i,nomorKK:a.target.value}),required:!0}),e.jsx(P,{label:"Hubungan",value:i.statusHubungan,onChange:a=>u({...i,statusHubungan:a.target.value}),options:["Kepala Keluarga","Suami","Istri","Anak","Menantu","Orang Tua","Mertua","Famili Lain"]}),e.jsx(w,{label:"Alamat Domisili",value:i.alamat,onChange:a=>u({...i,alamat:a.target.value})}),e.jsxs("div",{className:"flex items-center gap-2 bg-green-50 p-3 rounded border border-green-200",children:[e.jsx("input",{type:"checkbox",checked:i.isPendatang,onChange:a=>u({...i,isPendatang:a.target.checked}),className:"w-5 h-5 text-green-600 rounded"}),e.jsx("label",{className:"text-sm font-medium text-green-800",children:"Warga Pendatang (Baru Masuk)"})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-bold text-blue-700 border-b pb-2 flex gap-2",children:[e.jsx(Ce,{size:18})," Aset & Kepemilikan"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(P,{label:"Status Rumah",value:i.statusRumah,onChange:a=>u({...i,statusRumah:a.target.value}),options:["Milik Sendiri","Sewa/Kontrak","Menumpang"]}),e.jsx(P,{label:"BPJS",value:i.jenisBpjs,onChange:a=>u({...i,jenisBpjs:a.target.value}),options:["Tidak Memiliki","BPJS Mandiri","BPJS Kantor","BPJS PBI"]})]}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded border border-slate-200 space-y-3",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Kendaraan"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.hasMobil,onChange:a=>u({...i,hasMobil:a.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm w-16",children:"Mobil"}),e.jsx("input",{type:"text",disabled:!i.hasMobil,value:i.platMobil,onChange:a=>u({...i,platMobil:a.target.value}),placeholder:"Plat Nomor",className:"flex-1 border rounded px-2 py-1 text-sm disabled:bg-slate-100"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.hasMotor,onChange:a=>u({...i,hasMotor:a.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm w-16",children:"Motor"}),e.jsx("input",{type:"text",disabled:!i.hasMotor,value:i.platMotor,onChange:a=>u({...i,platMotor:a.target.value}),placeholder:"Plat Nomor",className:"flex-1 border rounded px-2 py-1 text-sm disabled:bg-slate-100"})]})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Catatan Tambahan"}),e.jsx("textarea",{value:i.catatan,onChange:a=>u({...i,catatan:a.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Contoh: Sakit menahun, butuh bantuan, dll."})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Foto Dokumen"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:te,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),q(i.files)]})]})]}),b==="activity"&&e.jsxs(e.Fragment,{children:[e.jsx(w,{label:"Nama Kegiatan",value:S.namaKegiatan,onChange:a=>C({...S,namaKegiatan:a.target.value}),required:!0}),e.jsx(w,{label:"Tanggal",type:"date",value:S.tanggal,onChange:a=>C({...S,tanggal:a.target.value}),required:!0}),e.jsx("textarea",{className:"w-full border p-2 rounded",rows:3,placeholder:"Deskripsi",value:S.deskripsi,onChange:a=>C({...S,deskripsi:a.target.value})}),e.jsx(w,{label:"Keterangan",value:S.keterangan,onChange:a=>C({...S,keterangan:a.target.value})}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Foto"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:te,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),q(S.files)]})]}),b==="complaint"&&e.jsxs(e.Fragment,{children:[e.jsx(w,{label:"Nama Pelapor",value:R.namaPelapor,onChange:a=>A({...R,namaPelapor:a.target.value}),required:!0}),e.jsx("textarea",{className:"w-full border p-2 rounded",rows:4,placeholder:"Isi Pengaduan...",value:R.deskripsi,onChange:a=>A({...R,deskripsi:a.target.value}),required:!0}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Foto Bukti"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:te,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),q(R.files)]})]}),e.jsx("div",{className:"pt-4 border-t sticky bottom-0 bg-white",children:e.jsx("button",{type:"submit",disabled:y,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold shadow hover:bg-blue-700 disabled:bg-blue-300 flex justify-center items-center gap-2",children:y?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"animate-spin"})," Menyimpan..."]}):"SIMPAN DATA"})})]})]})}),Ee&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[e.jsx(ea,{size:20})," Selesaikan Pengaduan"]}),e.jsx("button",{onClick:I,className:"text-gray-500 hover:text-red-500",children:e.jsx(X,{size:20})})]}),e.jsxs("form",{onSubmit:Ue,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Catatan / Tanggapan Penyelesaian"}),e.jsx("textarea",{value:K.tanggapan,onChange:a=>$({...K,tanggapan:a.target.value}),placeholder:"Contoh: Masalah telah diperbaiki pada hari Senin...",className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 h-24 resize-none",required:!0})]}),e.jsxs("div",{className:"border-t pt-2 mt-2",children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Bukti Foto Penyelesaian"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:Oe,className:"text-sm w-full file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),q(K.files,a=>$(s=>({...s,files:s.files.filter((t,l)=>l!==a)})))]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 shadow-sm",children:"Simpan Selesai"})]})]})]})})]})}function ce({active:n,onClick:o,icon:d,label:p}){return e.jsxs("button",{onClick:o,className:`flex items-center gap-1 px-3 py-2 text-sm font-medium border-b-2 transition ${n?"border-blue-600 text-blue-600":"border-transparent text-gray-500"}`,children:[d," ",p]})}function T({icon:n,label:o,value:d,color:p,active:r,onClick:c}){return e.jsxs("div",{onClick:c,className:`p-3 rounded-lg border flex items-center gap-3 cursor-pointer ${r?"ring-2 ring-blue-400 bg-blue-50":"bg-white"}`,children:[e.jsx("div",{className:`${p} text-white p-2 rounded shadow`,children:n}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase",children:o}),e.jsx("p",{className:"text-xl font-bold",children:d})]})]})}function De({data:n,onEdit:o,onDelete:d,onMove:p,onPreview:r}){const c=n.statusHubungan==="Kepala Keluarga";return e.jsxs("div",{className:`p-4 rounded-xl border shadow-sm ${n.isMoved?"bg-red-50":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center border",children:n.files&&n.files.length>0?e.jsx("img",{src:n.files[0],className:"w-full h-full object-cover cursor-pointer",onClick:()=>r(n.files[0])}):e.jsx(Te,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold truncate",children:n.nama}),e.jsx("p",{className:"text-xs text-gray-500",children:n.statusHubungan})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[n.isMoved&&e.jsx("span",{className:"text-[10px] bg-red-600 text-white px-2 py-0.5 rounded",children:"PINDAH"}),n.isPendatang&&!n.isMoved&&e.jsx("span",{className:"text-[10px] bg-green-600 text-white px-2 py-0.5 rounded",children:"PENDATANG"})]})]}),e.jsxs("div",{className:"mt-3 text-xs space-y-1 text-gray-600 border-t pt-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"NIK:"})," ",n.nik]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"KK:"})," ",n.nomorKK]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"JK:"})," ",n.jenisKelamin]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Gol.D:"})," ",n.golDarah]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Agama:"})," ",n.agama]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Status:"})," ",n.statusPerkawinan]})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Pekerjaan:"})," ",n.pekerjaan]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Alamat:"})," ",n.alamat]}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[n.hasMobil&&e.jsxs("span",{className:"text-[10px] bg-orange-100 text-orange-700 px-1 rounded flex items-center gap-1",children:[e.jsx(ca,{size:10})," ",n.platMobil]}),n.hasMotor&&e.jsxs("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1 rounded flex items-center gap-1",children:[e.jsx(ua,{size:10})," ",n.platMotor]})]}),n.files&&n.files.length>0&&e.jsx("div",{className:"flex gap-1 mt-2 overflow-x-auto pt-1",children:n.files.map((h,f)=>e.jsx("img",{src:h,className:"w-8 h-8 rounded object-cover border cursor-pointer hover:opacity-80",onClick:()=>r(h)},f))})]}),n.catatan&&e.jsxs("div",{className:"bg-yellow-50 p-2 rounded text-yellow-800 text-[10px] sm:text-xs mt-2 border border-yellow-100 flex gap-1 items-start",children:[e.jsx(ma,{size:12,className:"mt-0.5 flex-shrink-0"})," ",e.jsx("span",{children:n.catatan})]}),c&&!n.isMoved&&e.jsx("div",{className:"flex justify-between border-t pt-2 mt-2",children:e.jsxs("span",{className:"text-gray-500 text-[10px]",children:["Rumah: ",n.statusRumah]})}),n.isMoved&&e.jsxs("div",{className:"bg-red-100 p-2 rounded text-red-700 mt-2 text-xs",children:[e.jsxs("span",{className:"font-bold flex items-center gap-1",children:[e.jsx(Fe,{size:10})," Pindah ke:"]}),n.alamatPindah," (",n.tanggalPindah,")"]}),e.jsxs("div",{className:"mt-3 flex justify-between items-center pt-2 border-t",children:[!n.isMoved&&e.jsxs("button",{onClick:p,className:"text-orange-600 text-xs flex items-center gap-1",children:[e.jsx(xa,{size:12})," Pindah"]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsx("button",{onClick:o,className:"text-blue-600 bg-blue-50 p-1 rounded",children:e.jsx(ue,{size:16})}),e.jsx("button",{onClick:d,className:"text-red-600 bg-red-50 p-1 rounded",children:e.jsx(me,{size:16})})]})]})]})}function ba({data:n,memberCount:o,onClick:d}){return e.jsxs("div",{onClick:d,className:"p-4 rounded-xl border shadow-sm bg-white cursor-pointer hover:shadow-md flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 text-blue-600 p-2 rounded-full font-bold w-10 h-10 flex items-center justify-center overflow-hidden",children:n.files&&n.files.length>0?e.jsx("img",{src:n.files[0],className:"w-full h-full object-cover"}):n.nama[0]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:n.nama}),e.jsxs("p",{className:"text-xs text-gray-500",children:["KK: ",n.nomorKK]})]})]}),e.jsxs("div",{className:"text-xs bg-gray-100 px-2 py-1 rounded text-gray-600",children:[o," Anggota"]})]})}function w({label:n,name:o,type:d="text",value:p,onChange:r,placeholder:c,required:h,disabled:f,className:v}){const N=Y.useMemo(()=>`input-${o}-${Math.random().toString(36).substr(2,9)}`,[o]),y=k=>{if(d==="date"&&k.target.showPicker)try{k.target.showPicker()}catch{}};return e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsxs("label",{htmlFor:N,className:"text-sm font-medium text-gray-700 mb-1 block",children:[n," ",h&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:N,type:d,name:o,value:p,onChange:r,onClick:d==="date"?k=>y(k):void 0,placeholder:c,required:h,disabled:f,className:`px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition w-full min-h-[42px] ${v}`})]})}function P({label:n,name:o,value:d,onChange:p,options:r,required:c}){const h=Y.useMemo(()=>`select-${o}-${Math.random().toString(36).substr(2,9)}`,[o]);return e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsxs("label",{htmlFor:h,className:"text-sm font-medium text-gray-700 mb-1 block",children:[n," ",c&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{id:h,name:o,value:d,onChange:p,required:c,className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white w-full min-h-[42px]",children:r.map(f=>e.jsx("option",{value:f,children:f},f))})]})}class ja extends Y.Component{constructor(o){super(o),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(o){return{hasError:!0,error:o}}componentDidCatch(o,d){console.error("Uncaught error:",o,d),this.setState({errorInfo:d})}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"20px",color:"#721c24",backgroundColor:"#f8d7da",fontFamily:"sans-serif",height:"100vh",boxSizing:"border-box"},children:[e.jsx("h2",{style:{borderBottom:"1px solid #f5c6cb",paddingBottom:"10px"},children:"Oops, terjadi kesalahan fatal."}),e.jsx("p",{children:"Aplikasi mengalami crash. Mohon screenshot pesan di bawah ini dan kirimkan ke pengembang:"}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("strong",{children:"Error:"}),e.jsx("pre",{style:{background:"#fff",padding:"15px",borderRadius:"5px",overflowX:"auto",border:"1px solid #f5c6cb"},children:this.state.error&&this.state.error.toString()})]}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("strong",{children:"Stack Trace:"}),e.jsxs("details",{style:{whiteSpace:"pre-wrap",cursor:"pointer"},children:[e.jsx("summary",{children:"Klik untuk melihat detail"}),e.jsx("pre",{style:{background:"#fff",padding:"15px",borderRadius:"5px",overflowX:"auto",fontSize:"12px",marginTop:"5px",border:"1px solid #ccc"},children:this.state.errorInfo&&this.state.errorInfo.componentStack})]})]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"20px",padding:"10px 20px",cursor:"pointer",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"5px",fontSize:"16px"},children:"Muat Ulang Halaman"})]}):this.props.children}}const ze=document.getElementById("root");ze?ha(ze).render(e.jsx(Y.StrictMode,{children:e.jsx(ja,{children:e.jsx(fa,{})})})):console.error("Gagal menemukan elemen ID 'root' di index.html");
